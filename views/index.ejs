<html>
  <head>
    <title>JSONP</title>
    <style type="text/css">
      body {
        padding: 2em 3em;
        font-family: Helvetica, sans-serif;
      }
      p {
        max-width: 650px;
      }
      .finePrint {
        font-size: 0.8em;
      }
      .gist {
        margin-bottom: 1em;
      }
      .urlEntry {
        display: inline-block;
        padding: 5px 10px;
        background-color: #C9C9C9;
        border: 1px solid #818181;
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;
      }
      .urlEntry span {
        position: relative;
      }
      .urlEntry label {
        position: absolute;
        top: 0;
        left: 0.5em;
      }
      .urlEntry input {
        padding: 0.5em;
      }
      #footer {
        margin-top: 5em;
        padding: 1em;
        text-align: center;
        border-top: 1px solid #666;
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
    <script src="jquery.infieldlabel.js" type="text/javascript"></script>
    <script type="text/javascript">
      $(function(){
        $('.urlEntry label').inFieldLabels();
      });
    </script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-19048260-7']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
    <a href="https://github.com/afeld/jsonp"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
    <h1>JSONP <a href="https://travis-ci.org/#!/afeld/jsonp"><img src="https://secure.travis-ci.org/afeld/jsonp.png?branch=master" alt="Travis CI build status"/></a></h1>
    <h3>
      Enables cross-domain requests to <strong>any</strong> JSON API.
    </h3>
    <p>
      Very useful for mashup sites - since API calls can be done client-side, no server code is needed.  Note that exposing API secret keys in client code is discouraged.  The site is also available for secure domains using <a href="https://jsonp.nodejitsu.com">https://jsonp.nodejitsu.com</a> as the origin.  Examples in jQuery, though it is not required.
    </p>

    <h2>Easy: JSONP</h2>
    <script src="https://gist.github.com/2664597.js?file=jsonp.html"></script>
    <form class="urlEntry" action="" method="get">
      http://<%= host %>/?callback=<span><label for="callback">functionName</label><input type="text" name="callback"/>&amp;</span>url=<span><label for="url">API URL</label><input type="text" name="url"/></span>
      <input type="submit" value="Go"/>
    </form>

    <h2><em>Easier:</em> Cross-domain AJAX (<a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a>)</h2>
    <p class="finePrint">
      (<a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing#Browser_support">not supported</a> by IE &lt; 8)
    </p>
    <script src="https://gist.github.com/2664597.js?file=ajax.html"></script>
    <form class="urlEntry" action="" method="get">
      http://<%= host %>/?url=<span><label for="url">API URL</label><input type="text" name="url"/></span>
      <input type="submit" value="Go"/>
    </form>

    <p>
      Unfortunately, detection of response errors with JSONP is difficult, at best. jQuery's JSONP implementation won't call an error callback unless an explicit timeout is specified - see <a href="http://stackoverflow.com/questions/5247295/jquery-ajax-request-using-jsonp-error">here</a> for more info and options.
    </p>
    <p>
      CORS, however, is just normal AJAX!  There is also a security advantage, in that it's not possible for a malicious service (including this one) to run arbirtrary JavaScript on your page.
    </p>

    <div id="footer">
      <a href="https://twitter.com/aidanfeldman" class="twitter-follow-button" data-show-count="false">Follow @aidanfeldman</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
  </body>
</html>
